<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Monochrome LITE</title>
    <meta name="theme-color" content="#000">
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(r => r.forEach(sw => sw.unregister()));
        }
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; font-family: -apple-system, sans-serif; background: #000; color: #fff; overflow: hidden; }
        .app { display: flex; flex-direction: column; height: 100%; }
        .search-bar { padding: 12px; background: #111; }
        .search-input { width: 100%; padding: 12px; background: #222; border: none; border-radius: 8px; color: #fff; font-size: 16px; }
        .content { flex: 1; overflow-y: auto; }
        .message { padding: 20px; text-align: center; color: #666; }
        .track { display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #222; }
        .track.playing { background: #1a1a1a; }
        .track-cover { width: 48px; height: 48px; background: #333; border-radius: 4px; margin-right: 12px; }
        .track-info { flex: 1; overflow: hidden; }
        .track-title { font-size: 15px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .track-artist { font-size: 13px; color: #888; }
        .now-playing { background: #111; padding: 12px; }
        .np-row { display: flex; align-items: center; margin-bottom: 8px; }
        .np-cover { width: 40px; height: 40px; background: #333; border-radius: 4px; margin-right: 10px; background-size: cover; }
        .np-text { flex: 1; }
        .np-title { font-size: 14px; }
        .np-artist { font-size: 12px; color: #888; }
        .progress { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        .progress-time { font-size: 11px; color: #666; width: 35px; }
        .progress-bar { flex: 1; height: 4px; background: #333; border-radius: 2px; }
        .progress-fill { height: 100%; background: #fff; border-radius: 2px; width: 0; }
        .controls { display: flex; justify-content: center; gap: 24px; }
        .btn { background: none; border: none; color: #fff; font-size: 24px; padding: 8px; }
        .loading { display: inline-block; width: 16px; height: 16px; border: 2px solid #333; border-top-color: #fff; border-radius: 50%; animation: spin .8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>
<div class="app">
    <div class="search-bar"><input class="search-input" id="q" placeholder="Search tracks..."></div>
    <div class="content" id="c"><div class="message">üéµ LITE<br><small>Search for music</small></div></div>
    <div class="now-playing">
        <div class="np-row"><div class="np-cover" id="npC"></div><div class="np-text"><div class="np-title" id="npT">-</div><div class="np-artist" id="npA">-</div></div></div>
        <div class="progress"><span class="progress-time" id="cur">0:00</span><div class="progress-bar" id="bar"><div class="progress-fill" id="fill"></div></div><span class="progress-time" id="dur">0:00</span></div>
        <div class="controls"><button class="btn" id="prev">‚èÆ</button><button class="btn" id="play">‚ñ∂</button><button class="btn" id="next">‚è≠</button></div>
    </div>
</div>
<audio id="a" crossorigin="anonymous"></audio>
<script>
(function(){
    const API=['https://api.monochrome.tf/','https://wolf.qqdl.site/'];
    let Q=[],I=-1,P=false,a=document.getElementById('a');
    const $=id=>document.getElementById(id);
    async function api(p){for(let b of API){try{let r=await fetch(b+p);if(r.ok)return r.json();}catch(e){}}throw 0;}
    async function search(s){let j=await api('search/?s='+encodeURIComponent(s));return(j.data||j).items||[];}
    async function stream(id){let j=await api('track/?id='+id+'&quality=LOSSLESS'),d=j.data||j;if(d.manifest)try{return JSON.parse(atob(d.manifest)).urls[0];}catch(e){}return null;}
    function img(id){return id?'https://resources.tidal.com/images/'+id.replace(/-/g,'/')+'/160x160.jpg':'';}
    function fmt(s){return isNaN(s)?'0:00':Math.floor(s/60)+':'+String(Math.floor(s%60)).padStart(2,'0');}
    let T;$('q').oninput=e=>{clearTimeout(T);let v=e.target.value.trim();if(v.length<2)return;T=setTimeout(async()=>{$('c').innerHTML='<div class="message"><span class="loading"></span></div>';try{Q=await search(v);render();}catch(e){$('c').innerHTML='<div class="message">Error</div>';}},300);};
    function render(){if(!Q.length){$('c').innerHTML='<div class="message">No results</div>';return;}$('c').innerHTML=Q.map((t,i)=>'<div class="track'+(i===I?' playing':'')+'" data-i="'+i+'"><img class="track-cover" src="'+img(t.album?.cover)+'"><div class="track-info"><div class="track-title">'+t.title+'</div><div class="track-artist">'+(t.artist?.name||t.artists?.[0]?.name||'')+'</div></div></div>').join('');}
    $('c').onclick=e=>{let t=e.target.closest('.track');if(t)play(+t.dataset.i);};
    async function play(i){if(i<0||i>=Q.length)return;I=i;let t=Q[i];$('npT').textContent=t.title;$('npA').textContent=t.artist?.name||t.artists?.[0]?.name||'';$('npC').style.backgroundImage='url('+img(t.album?.cover)+')';render();$('play').innerHTML='<span class="loading"></span>';try{let u=await stream(t.id);if(u){a.src=u;a.play();}else throw 0;}catch(e){$('play').textContent='‚ñ∂';}}
    a.onplay=()=>{P=true;$('play').textContent='‚è∏';};
    a.onpause=()=>{P=false;$('play').textContent='‚ñ∂';};
    a.ontimeupdate=()=>{if(a.duration){$('fill').style.width=(a.currentTime/a.duration*100)+'%';$('cur').textContent=fmt(a.currentTime);$('dur').textContent=fmt(a.duration);}};
    a.onended=()=>play((I+1)%Q.length);
    $('play').onclick=()=>{if(a.src){P?a.pause():a.play();}else if(Q.length)play(0);};
    $('prev').onclick=()=>{a.currentTime>3?a.currentTime=0:play((I-1+Q.length)%Q.length);};
    $('next').onclick=()=>play((I+1)%Q.length);
    $('bar').onclick=e=>{if(a.duration)a.currentTime=(e.offsetX/e.target.offsetWidth)*a.duration;};
})();
</script>
</body>
</html>
